<!-- artifactsAssociatedæ„ä»¶å…³è” -->
<template>
  <div class="container-artifacts-associated">
    <el-row>
      <el-col :span="2">
        <el-button @click="selected=false" :class="{selected:!selected}">æ¸…å•å…³è”</el-button>
      </el-col>
      <el-col :span="2">
        <el-button @click="selected=true" :class="{selected:selected}">æ„ä»¶å…³è”</el-button>
      </el-col>
      <el-col :span="2" :offset="7">
        <el-button type="warning" @click="getCheckedKeys">ç¡®è®¤å…³è”</el-button>
      </el-col>
      <el-col :span="2" :offset="9">
        <el-button type="primary" @click="centerDialogVisible = true">
          <img src="../../../assets/icons/match.png"> æ¸…å•ä¸€é”®åŒ¹é…
        </el-button>
      </el-col>
    </el-row>

    <el-row :gutter="20">
      <el-col :span="5">
        <header>æ„ä»¶æ¸…å•</header>
        <el-select v-model="value" placeholder="è¯·é€‰æ‹©" id="select1">
          <el-option
            v-for="item in options"
            :key="item.value"
            :label="item.label"
            :value="item.value"
          ></el-option>
        </el-select>
        <el-tree
          :data="data2"
          show-checkbox
          default-expand-all
          node-key="id"
          ref="tree"
          highlight-current
          :props="defaultProps"
        ></el-tree>
      </el-col>
      <el-col :span="7" v-show="!selected">
        <el-select v-model="value2" placeholder="è¯·é€‰æ‹©">
          <el-option
            v-for="item in options2"
            :key="item.value"
            :label="item.label"
            :value="item.value"
          ></el-option>
        </el-select>
        <el-editable
          ref="editable"
          class="manual-table5"
          :edit-config="{trigger: 'manual', mode: 'row',clearActiveMethod}"
          :edit-rules="validRules"
          :data.sync="list"
          @clear-active="clearActiveEvent"
          @selection-change="handleSelectionChange"
        >
          <el-editable-column label width="45">
            <!-- <template slot="header">
              <el-checkbox
                v-model="treeAllCheck"
                :indeterminate="treeAllIndeterminate"
                @change="treeAllChange(treeAllCheck)"
              ></el-checkbox>
            </template>-->
            <template slot-scope="scope">
              <i
                class="tree-expand-icon fa"
                :class="treeIcons(scope.row)"
                @click="toggleCollapseNode(scope.row)"
              ></i>
              <el-checkbox
                v-model="scope.row.isCheck"
                :indeterminate="scope.row.indeterminate"
                @change="treeNodeChange(scope.row)"
                v-show="~~scope.row.fileType==0"
              ></el-checkbox>
            </template>
          </el-editable-column>
          <el-editable-column prop="name" label="æ„ä»¶åç§°" :edit-render="{name: 'ElInput'}"></el-editable-column>
          <el-editable-column prop="m1" label="æ··å‡åœŸç Œå—(mÂ³)" :edit-render="{name: 'ElInputNumber'}"></el-editable-column>
          <el-editable-column prop="m2" label="æ¨¡æ¿é¢ç§¯ï¼ˆã¡ï¼‰" :edit-render="{name: 'ElInputNumber'}"></el-editable-column>
          <el-editable-column width="50">
            <template slot-scope="scope">
              <!-- hasActiveRow åˆ¤æ–­å½“å‰æ˜¯å¦æ´»åŠ¨è¡Œ -->
              <template v-if="$refs.editable.hasActiveRow(scope.row)">
                <i class="el-icon-check" @click="saveRowEvent(scope.row)"></i>
                <i class="el-icon-close" @click="cancelRowEvent(scope.row)"></i>
              </template>
              <template v-else>
                <i
                  class="el-icon-plus"
                  @click="insertEvent(scope.row)"
                  v-show="scope.row.fileType==1&scope.row.expandNode"
                ></i>
                <i
                  class="el-icon-delete"
                  @click="removeEvent(scope.row)"
                  v-show="~~scope.row.fileType==0"
                ></i>
              </template>
            </template>
          </el-editable-column>
        </el-editable>
      </el-col>
      <el-col :span="7" v-show="selected">
        <el-table
          :data="tableData2"
          highlight-current-row
          @row-click="clickItem"
          :header-cell-class-name="tableheaderClassName"
          style="width: 100%"
        >
          <el-table-column label width="50">
            <template slot-scope="scope">
              <el-radio v-model="radio" :label="scope.row.id">
                <i></i>
              </el-radio>
            </template>
          </el-table-column>
          <el-table-column prop="name" label="ä»»åŠ¡åç§°"></el-table-column>
          <el-table-column prop="date" label="è®¡åˆ’å®Œæˆæ—¶é—´"></el-table-column>
          <el-table-column prop="duration" label="å·¥æœŸ" show-overflow-tooltip></el-table-column>
        </el-table>
      </el-col>
      <el-col :span="12">3</el-col>
    </el-row>

    <el-dialog title="å­—æ®µæ˜ å°„" :visible.sync="centerDialogVisible" width="40%" center>
      <!-- <span>éœ€è¦æ³¨æ„çš„æ˜¯å†…å®¹æ˜¯é»˜è®¤ä¸å±…ä¸­çš„</span> -->
      <el-row>
        <el-col :offset="5" :span="9">
          <div class="grid-content bg-purple">æ¨¡å‹</div>
        </el-col>
        <el-col :span="10">
          <div class="grid-content bg-purple-light">å·¥ç¨‹é‡æ¸…å•</div>
        </el-col>
      </el-row>
      <el-form ref="form" :model="form" label-width="80px">
        <el-form-item label="æ¥¼å±‚åŒ¹é…">
          <el-select v-model="form.floor" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in options3"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            ></el-option>
          </el-select>
          <el-select v-model="form.floor2" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in options4"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            ></el-option>
          </el-select>
          <div @click="addDomain(item)" class="add_btn"></div>
        </el-form-item>
        <el-form-item label="æ„ä»¶åŒ¹é…">
          <el-select v-model="form.artifact" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in options3"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            ></el-option>
          </el-select>
          <el-select v-model="form.artifact2" placeholder="è¯·é€‰æ‹©">
            <el-option
              v-for="item in options4"
              :key="item.value"
              :label="item.label"
              :value="item.value"
            ></el-option>
          </el-select>
          <div @click="addDomain(item)" class="add_btn"></div>
        </el-form-item>
      </el-form>
      <span slot="footer" class="dialog-footer">
        <el-button @click="centerDialogVisible = false">å– æ¶ˆ</el-button>
        <el-button class="selected" @click="centerDialogVisible = false">ä¸€é”®åŒ¹é…</el-button>
      </span>
    </el-dialog>
  </div>
</template>

<script type='textecmascript-6'>
import Vue from "vue";
import ElementUI from "element-ui";
import { Message, MessageBox } from "element-ui";
Vue.use(ElementUI);
import VueX from "vuex";
Vue.use(VueX);
import VueElementExtends from "vue-element-extends";
import "vue-element-extends/lib/index.css";
Vue.use(VueElementExtends);
import XEUtils from "xe-utils";

export default {
  data() {
    return {
      forbidden: true,
      radio: "", //æ„ä»¶å…³è” å•é€‰
      selected: false, //æ§åˆ¶æ˜¾ç¤ºæ¸…å•å…³è”è¿˜æ˜¯æ„ä»¶å…³è”
      centerDialogVisible: false, //æ§åˆ¶æ¨¡æ€æ¡†æ˜¾ç¤ºä¸å¦
      loading: false,
      isClearActiveFlag: true,
      treeAllCheck: false,
      treeAllIndeterminate: false,
      currentRow: null,
      validRules: {
        //æ–°å¢è¡ŒéªŒè¯è§„åˆ™
        name: [{ required: true, message: "è¯·è¾“å…¥æ„ä»¶åç§°", trigger: "blur" }],
        m1: [{ required: true, message: "è¯·è¾“å…¥æ··å‡åœŸç Œå—", trigger: "blur" }],
        m2: [{ required: true, message: "è¯·è¾“å…¥æ¨¡æ¿é¢ç§¯", trigger: "blur" }]
      },
      list: [],
      treeNode: [],
      treeList: [],
      data2: [
        {
          label: "æ•´ä½“æ¨¡å‹",
          children: [
            {
              label: "å»ºç­‘ä¸“ä¸š",
              children: [
                {
                  id: 1,
                  label: "1F"
                },
                {
                  id: 2,
                  label: "2F"
                },
                {
                  id: 3,
                  label: "3F"
                },
                {
                  id: 4,
                  label: "4F"
                },
                {
                  id: 5,
                  label: "5F"
                },
                {
                  id: 6,
                  label: "6F"
                }
              ]
            }
          ]
        }
      ],
      defaultProps: {
        children: "children",
        label: "label"
      },
      options: [
        {
          value: "é€‰é¡¹1",
          label: "æ•´ä½“æ¨¡å‹-XXXæ˜“åœ°æ‰¶è´«æ¬è¿é¡¹ç›®"
        },
        {
          value: "é€‰é¡¹2",
          label: "æ•´ä½“æ¨¡å‹-XXXæ˜“åœ°æ‰¶è´«æ¬è¿é¡¹ç›®1"
        },
        {
          value: "é€‰é¡¹3",
          label: "æ•´ä½“æ¨¡å‹-XXXæ˜“åœ°æ‰¶è´«æ¬è¿é¡¹ç›®2"
        },
        {
          value: "é€‰é¡¹4",
          label: "æ•´ä½“æ¨¡å‹-XXXæ˜“åœ°æ‰¶è´«æ¬è¿é¡¹ç›®3"
        },
        {
          value: "é€‰é¡¹5",
          label: "æ•´ä½“æ¨¡å‹-XXXæ˜“åœ°æ‰¶è´«æ¬è¿é¡¹ç›®4"
        }
      ],
      value: "",
      options2: [
        {
          value: "é€‰é¡¹1",
          label: "A1æ ‹-æ–½å·¥å›¾é¢„ç®—å·¥ç¨‹é‡æ¸…å•-å¢™"
        },
        {
          value: "é€‰é¡¹2",
          label: "A1æ ‹-æ–½å·¥å›¾é¢„ç®—å·¥ç¨‹é‡æ¸…å•-å®¶å…·"
        },
        {
          value: "é€‰é¡¹3",
          label: "æ•´A1æ ‹-æ–½å·¥å›¾é¢„ç®—å·¥ç¨‹é‡æ¸…å•-æˆ¿é—´"
        },
        {
          value: "é€‰é¡¹4",
          label: "A1æ ‹-æ–½å·¥å›¾é¢„ç®—å·¥ç¨‹é‡æ¸…å•-é—¨"
        },
        {
          value: "é€‰é¡¹5",
          label: "A1æ ‹-æ–½å·¥å›¾é¢„ç®—å·¥ç¨‹é‡æ¸…å•-çª—"
        }
      ],
      value2: "",
      tableData2: [
        {
          id: 1,
          date: "2019.01.07",
          name: "1Fä¸»ä½“ç»“æ„",
          duration: "6"
        },
        {
          id: 2,
          date: "2019.01.08",
          name: "2Fä¸»ä½“ç»“æ„",
          duration: "9"
        },
        {
          id: 3,
          date: "2019.01.09",
          name: "3Fä¸»ä½“ç»“æ„",
          duration: "5"
        },
        {
          id: 4,
          date: "2019.01.10",
          name: "4Fä¸»ä½“ç»“æ„",
          duration: "6"
        },
        {
          id: 5,
          date: "2019.01.11",
          name: "5Fä¸»ä½“ç»“æ„",
          duration: "5"
        },
        {
          id: 6,
          date: "2019.01.12",
          name: "6Fä¸»ä½“ç»“æ„",
          duration: "6"
        }
      ],
      // currentRow: null, //å•é€‰
      options3: [
        {
          value: "é€‰é¡¹1",
          label: "1F"
        },
        {
          value: "é€‰é¡¹2",
          label: "2F"
        },
        {
          value: "é€‰é¡¹3",
          label: "3F"
        },
        {
          value: "é€‰é¡¹4",
          label: "4F"
        },
        {
          value: "é€‰é¡¹5",
          label: "5F"
        }
      ],
      value3: "",
      options4: [
        {
          value: "é€‰é¡¹1",
          label: "ç¬¬ä¸€å±‚"
        },
        {
          value: "é€‰é¡¹2",
          label: "ç¬¬äºŒå±‚"
        },
        {
          value: "é€‰é¡¹3",
          label: "ç¬¬ä¸‰å±‚"
        },
        {
          value: "é€‰é¡¹4",
          label: "ç¬¬å››å±‚"
        },
        {
          value: "é€‰é¡¹5",
          label: "ç¬¬äº”å±‚"
        }
      ],
      value4: "",
      form: {
        floor: "",
        artifact: "",
        floor2: "",
        artifact2: ""
      }
    };
  },
  created() {
    this.init();
  },
  methods: {
    //è·å–é€‰ä¸­çš„æ ‘èŠ‚ç‚¹ç»„æˆçš„æ•°ç»„
    getCheckedKeys() {
      console.log(this.$refs.tree.getCheckedKeys(true)); //(leafOnly) æ¥æ”¶ä¸€ä¸ª boolean ç±»å‹çš„å‚æ•°ï¼Œè‹¥ä¸º true åˆ™ä»…è¿”å›è¢«é€‰ä¸­çš„å¶å­èŠ‚ç‚¹çš„ keysï¼Œé»˜è®¤å€¼ä¸º false
      this.multipleSelection = this.$refs.tree.getCheckedKeys(true);
      console.log(this.multipleSelection);
    },
    //è·å–é€‰ä¸­è¡¨æ ¼ä¸­çš„æ•°æ®ç»„æˆçš„æ•°ç»„
    handleSelectionChange(val) {
      this.multipleSelection = val.map(val => val.id);
      console.log(this.multipleSelection);
    },
    // resetChecked() {
    //   this.$refs.tree.setCheckedKeys([]);
    // }
    //ä¿®æ”¹è¡¨æ ¼è¡¨å¤´çš„èƒŒæ™¯é¢œè‰²
    tableheaderClassName() {
      return "table-head-th";
    },
    setCurrent(row) {
      this.$refs.singleTable.setCurrentRow(row);
    },
    // 	å½“æŸä¸€è¡Œè¢«ç‚¹å‡»æ—¶ä¼šè§¦å‘è¯¥äº‹ä»¶
    clickItem(row) {
      console.log(this.radio);
      console.log(row.id);

      // if (!this.forbidden) {
      //   this.forbidden = true;
      //   return;
      // }
      // if (this.radio) {
      //   if (this.radio == row.id) {
      //     this.radio = "";
      //     //è¡Œç‚¹å‡»åçš„ ç»§ç»­è§¦å‘radioç‚¹å‡»ï¼Œç¦æ­¢
      //     this.forbidden = false;
      //     setTimeout(() => {
      //       this.forbidden = true;
      //     }, 0);
      //     return;
      //   }
      //   // ç»‘å®šé€‰ä¸­çš„æ•°æ®
      //   this.radio = row.id;
      // }
      this.radio = row.id === this.radio ? "" : row.id;
    },
    // æ–°å¢ select æ¡†
    // addSelect() {}
    // æ ‘è¡¨æ ¼çš„é€»è¾‘
    init() {
      this.findList();
    },
    clearActiveMethod() {
      return this.isClearActiveFlag;
    },
    findList() {
      this.loading = true;
      return this.loadList()
        .then(() => {
          this.loading = false;
        })
        .catch(() => {
          this.loading = false;
        });
    },
    //
    loadList() {
      return this.getDataJSON().then(data => {
        this.initTreeList(data);
      });
    },
    getChildren(row) {
      return this.treeList.filter(item => item.parentId === row.id);
    },
    hasDirectory(row) {
      return this.getChildren(row).length > 0;
    },
    reloedTreeList(data) {
      this.initTreeList(data, true);
    },
    // å°†ä¸€ä¸ªå¸¦å±‚çº§çš„æ•°æ®åˆ—è¡¨è½¬æˆæ ‘ç»“æ„
    initTreeList(data, isReload) {
      // toArrayTree ( array, options ) ä¸€ä¸ªé«˜æ€§èƒ½çš„æ ‘ç»“æ„è½¬æ¢å‡½æ•°ï¼Œå°†ä¸€ä¸ªå¸¦å±‚çº§çš„æ•°æ®åˆ—è¡¨è½¬æˆæ ‘ç»“æ„
      // è‡ªå®šä¹‰æ•°æ®å­˜æ”¾å±æ€§
      let treeNode = XEUtils.toArrayTree(data, {
        key: "id",
        parentKey: "parentId",
        children: "children"
      });
      // toTreeArray ( array, options ) å°†ä¸€ä¸ªæ ‘ç»“æ„è½¬æˆæ•°ç»„åˆ—è¡¨
      let treeList = XEUtils.toTreeArray(treeNode, { children: "children" });
      if (!isReload) {
        treeList.forEach(item => {
          Object.assign(item, {
            expandNode: false,
            showNode: false,
            isCheck: false,
            indeterminate: false
          });
        });
      }
      this.treeNode = treeNode; // ç›®å½•èŠ‚ç‚¹
      this.treeList = treeList; // å…¨éƒ¨èŠ‚ç‚¹
      if (!isReload) {
        treeNode.forEach((item, index) => {
          Object.assign(item, {
            treeLevel: 0,
            treeIndex: index,
            showNode: true
          });
        });
      }
      this.loadTree();
    },
    // åˆ¤æ–­è¡¨æ ¼å±•å¼€ä¸å¦çš„å›¾æ ‡æ ·å¼
    treeIcons(row) {
      let clsName =
        row.fileType === "1"
          ? row.expandNode
            ? "el-icon-caret-bottom"
            : "el-icon-caret-top"
          : "";
      return clsName;
    },
    //
    // treeAllChange(value) {
    //   this.treeAllIndeterminate = false;
    //   this.treeList.forEach(item => {
    //     item.isCheck = value;
    //     item.indeterminate = false;
    //   });
    // },
    treeNodeChange(row) {
      if (row.isCheck) {
        row.indeterminate = false;
      }
      this.treeCheckChildNode(row, row.isCheck);
      this.treeCheckParentNode(row);
    },
    treeCheckParentNode(row) {
      let parent = this.treeList.find(item => item.id === row.parentId);
      if (parent) {
        let children = this.treeList.filter(
          item => item.parentId === parent.id
        );
        parent.isCheck = children.every(item => item.isCheck);
        parent.indeterminate =
          !parent.isCheck &&
          !children.every(item => !item.isCheck && !item.indeterminate);
        this.treeCheckParentNode(parent);
      } else {
        let children = this.treeNode;
        this.treeAllCheck = children.every(item => item.isCheck); // å½“å‰é¡¹æ˜¯å¦è¢«é€‰ä¸­
        this.treeAllIndeterminate =
          !this.treeAllCheck &&
          !children.every(item => !item.isCheck && !item.indeterminate);
      }
    },
    treeCheckChildNode(parent, check) {
      let children = this.treeList.filter(item => item.parentId === parent.id);
      children.forEach((child, index) => {
        child.isCheck = check;
        child.treeIndex = index;
        child.treeLevel = parent.treeLevel + 1;
        this.treeCheckChildNode(child, check);
      });
    },
    //
    treeCollapseNode(parent, expand) {
      let children = this.treeList.filter(item => item.parentId === parent.id);
      parent.expandNode = !!(expand && children.length);
      children.forEach((child, index) => {
        child.treeIndex = index;
        child.treeLevel = parent.treeLevel + 1;
        child.showNode = expand !== null ? expand : false;
        this.treeCollapseNode(child, null);
      });
    },
    loadTree() {
      this.list = this.treeList.filter(item => item.showNode); // ç›®å½• list
    },
    treeRowClassName({ row }) {
      let clsName = `tree-level_${row.treeLevel}`;
      if (this.currentRow && this.currentRow.id === row.id) {
        clsName += " current-row";
      }
      return clsName;
    },
    // åˆ‡æ¢ å±•å¼€èŠ‚ç‚¹
    toggleCollapseNode(row) {
      this.treeCollapseNode(row, !row.expandNode);
      this.loadTree();
    },
    // rowClickEvent(row) {
    //   this.currentRow = row;
    // },
    /**
    selectRow:æ–°å¢çš„ä¸€è¡Œæ•°æ®çš„çˆ¶çº§æ•°æ®
    file:æ–°å¢çš„ä¸€è¡Œæ•°æ®
    */
    insertEvent(selectRow, type = 0, file) {
      if (!this.$refs.editable.checkValid().error) {
        let children = [];
        let isAppand = false;
        let index = selectRow
          ? XEUtils.findIndexOf(this.list, item => item.id === selectRow.id)
          : 0;
        let data = Object.assign(
          {
            isNew: true,
            id: Date.now(),
            fileType: type,
            parentId: null,
            treeLevel: 0,
            treeIndex: 0,
            expandNode: false,
            showNode: true,
            isCheck: false,
            indeterminate: false
          },
          file
        );

        if (selectRow) {
          children = this.getChildren(selectRow);
          isAppand =
            selectRow.fileType === "1" &&
            (selectRow.expandNode || !children.length);
          if (isAppand) {
            selectRow.expandNode = true;
            data.parentId = selectRow.id;
            data.treeLevel = selectRow.treeLevel + 1;
          } else {
            data.parentId = selectRow.parentId;
            data.treeLevel = selectRow.treeLevel;
          }
        }
        let row = this.$refs.editable.insertAt(
          data,
          isAppand ? index + children.length + 1 : index
        );
        // let row = this.$refs.editable.insert(data);
        this.currentRow = row;
        this.$nextTick(() => {
          if (selectRow) {
            let dataIndex = XEUtils.findIndexOf(
              this.treeList,
              item => item.id === selectRow.id
            );
            this.treeList.splice(
              isAppand ? dataIndex + children.length + 1 : dataIndex,
              0,
              row
            );
          } else {
            this.treeList.push(row);
          }
          this.reloedTreeList(this.treeList);
          if (!file) {
            this.$nextTick(() => this.$refs.editable.setActiveRow(row)); // setActiveRow åªå¯¹ mode=row æœ‰æ•ˆï¼Œæ¿€æ´»æŒ‡å®šè¡Œè¡Œä¸ºå¯ç¼–è¾‘çŠ¶æ€
          }
        });
      }
    },
    openActiveRowEvent(row) {
      let activeInfo = this.$refs.editable.getActiveRow();
      // å¦‚æœå½“å‰è¡Œæ­£åœ¨ç¼–è¾‘ä¸­ï¼Œç¦æ­¢ç¼–è¾‘å…¶ä»–è¡Œ
      if (activeInfo) {
        if (activeInfo.row === row || !this.$refs.editable.checkValid().error) {
          if (activeInfo.isUpdate) {
            this.isClearActiveFlag = false;
            MessageBox.confirm(
              "æ£€æµ‹åˆ°æœªä¿å­˜çš„å†…å®¹ï¼Œæ˜¯å¦åœ¨ç¦»å¼€å‰ä¿å­˜ä¿®æ”¹?",
              "æ¸©é¦¨æç¤º",
              {
                distinguishCancelAndClose: true,
                confirmButtonText: "ä¿å­˜",
                cancelButtonText: "æ”¾å¼ƒä¿®æ”¹",
                type: "warning"
              }
            )
              .then(() => {
                this.$refs.editable.setActiveRow(row);
                this.updateRowEvent(activeInfo.row);
              })
              .catch(action => {
                if (action === "cancel") {
                  this.$refs.editable.revert(activeInfo.row);
                  this.$refs.editable.setActiveRow(row);
                  Message({ message: "æ”¾å¼ƒä¿®æ”¹å¹¶ç¦»å¼€å½“å‰è¡Œ", type: "warning" });
                } else {
                  Message({ message: "åœç•™åœ¨å½“å‰è¡Œç¼–è¾‘", type: "info" });
                }
              })
              .then(() => {
                this.isClearActiveFlag = true;
              });
          } else {
            this.$refs.editable.setActiveRow(row);
          }
        }
      } else {
        this.$refs.editable.setActiveRow(row);
      }
    },
    // å–æ¶ˆä¿å­˜å½“å‰ç¼–è¾‘è¡Œ ğŸ™‚
    cancelRowEvent(row) {
      console.log(row);
      let activeInfo = this.$refs.editable.getActiveRow(); // getActiveRow è·å–å½“å‰æ´»åŠ¨è¡Œæˆ–åˆ—çš„ä¿¡æ¯
      if (activeInfo && activeInfo.isUpdate) {
        MessageBox.confirm("æ£€æµ‹åˆ°æœªä¿å­˜çš„å†…å®¹ï¼Œç¡®å®šæ”¾å¼ƒä¿®æ”¹?", "æ¸©é¦¨æç¤º", {
          confirmButtonText: "æ”¾å¼ƒæ›´æ”¹",
          cancelButtonText: "è¿”å›",
          type: "warning"
        })
          .then(action => {
            if (action === "confirm") {
              this.$refs.editable.clearActive(); // clearActive æ¸…é™¤æ‰€æœ‰æ´»åŠ¨è¡Œæˆ–åˆ—ä¸ºä¸å¯ç¼–è¾‘çŠ¶æ€
              // this.$refs.editable.revert(row); // revert æ”¾å¼ƒæ›´æ”¹ï¼Œè¿˜åŸæŒ‡å®šè¡Œ row æˆ–è€…æ•´ä¸ªè¡¨æ ¼çš„æ•°æ®
              this.$refs.editable.remove(row); // remove æ ¹æ®æ•°æ®åˆ é™¤
              this.treeList = this.treeList.filter(item => item.id !== row.id); // ç„¶åä¸€å®šè¦åœ¨ this.treeList ä¸­åˆ é™¤ row
              this.updateRowEvent(row);
            } else {
              this.$refs.editable.setActiveRow(row); // setActiveRow åªå¯¹ mode=row æœ‰æ•ˆï¼Œæ¿€æ´»æŒ‡å®šè¡Œè¡Œä¸ºå¯ç¼–è¾‘çŠ¶æ€
            }
          })
          .catch(e => e);
      } else {
        this.$refs.editable.clearActive();
      }
    },
    // ç§»é™¤å½“å‰è¡Œ ğŸ™‚
    removeEvent(row) {
      MessageBox.confirm("ç¡®å®šåˆ é™¤è¯¥è¡Œæ•°æ®?", "æ¸©é¦¨æç¤º", {
        confirmButtonText: "ç¡®å®š",
        cancelButtonText: "å–æ¶ˆ",
        type: "warning"
      })
        .then(() => {
          this.$refs.editable.remove(row); // é¦–å…ˆåœ¨ editable ä¸­åˆ é™¤ row
          this.treeList = this.treeList.filter(item => item.id !== row.id); // ç„¶åä¸€å®šè¦åœ¨ this.treeList ä¸­åˆ é™¤ row
          this.updateRowEvent(row);
        })
        .catch(e => e);
    },
    clearActiveEvent(row) {
      this.updateRowEvent(row);
    },
    //æ›´æ–°æ ‘è¡¨æ ¼æ•°æ®
    updateRowEvent(row) {
      // this.$refs.editable.reloadRow(row); // reloadRow() åˆå§‹åŒ–æŒ‡å®šè¡Œæ•°æ®
      Message({ message: "ä¿å­˜æˆåŠŸ", type: "success" });
    },
    //ä¿å­˜å½“å‰ç¼–è¾‘è¡Œ
    saveRowEvent(row) {
      this.$refs.editable.validateRow(row, valid => {
        if (valid) {
          this.$refs.editable.clearActive(); //æ¸…é™¤æ‰€æœ‰æ´»åŠ¨è¡Œæˆ–åˆ—ä¸ºä¸å¯ç¼–è¾‘çŠ¶æ€
          this.$refs.editable.reloadRow(row); //åˆå§‹åŒ–æŒ‡å®šè¡Œæ•°æ®
          Message({ message: "ä¿å­˜æˆåŠŸ", type: "success" });
        } else {
          this.$refs.editable.revert(row); // æ”¾å¼ƒæ›´æ”¹ï¼Œè¿˜åŸæŒ‡å®šè¡Œ row æˆ–è€…æ•´ä¸ªè¡¨æ ¼çš„æ•°æ®
          // console.log("error row submit!!");
        }
      });
    },
    getInsertEvent() {
      let rest = this.treeList.filter(item => item.isNew);
      MessageBox({
        message: JSON.stringify(rest),
        title: `è·å–æ‰€æœ‰æ•°æ®(${rest.length}æ¡)`
      }).catch(e => e);
    },
    //æ¨¡æ‹Ÿæ•°æ®
    getDataJSON() {
      return new Promise(resolve => {
        setTimeout(
          () =>
            resolve([
              {
                id: 1,
                name: "åŸºç¡€å¢™1",
                fileType: "1",
                parentId: null
              },
              {
                id: 11,
                name: "ç Œä½“å¢™-11",
                fileType: "0",
                parentId: 1,
                m1: "69.65",
                m2: "69.65"
              },
              {
                id: 12,
                name: "ç Œä½“å¢™-12",
                fileType: "0",
                parentId: 1,
                m1: "69.95",
                m2: "69.65"
              },
              {
                id: 2,
                name: "åŸºç¡€å¢™2",
                fileType: "1",
                parentId: null
              },
              {
                id: 21,
                name: "ç Œä½“å¢™-21",
                fileType: "0",
                parentId: 2,
                m1: "69.65",
                m2: "69.65"
              },
              {
                id: 22,
                name: "ç Œä½“å¢™-22",
                fileType: "0",
                parentId: 2,
                m1: "69.95",
                m2: "69.65"
              },
              {
                id: 23,
                name: "ç Œä½“å¢™-23",
                fileType: "0",
                parentId: 2,
                m1: "69.95",
                m2: "69.65"
              },
              {
                id: 24,
                name: "ç Œä½“å¢™-24",
                parentId: 2,
                fileType: "0",
                m1: "69.95",
                m2: "69.65"
              },
              {
                id: 25,
                name: "ç Œä½“å¢™-25",
                parentId: 2,
                fileType: "0",
                m1: "69.95",
                m2: "69.65"
              },
              {
                id: 26,
                name: "ç Œä½“å¢™-26",
                parentId: 2,
                fileType: "0",
                m1: "69.95",
                m2: "69.65"
              }
            ]),
          350
        );
      });
    }
  }
};
</script>

<style>
.container-artifacts-associated * {
  font-size: 28px; /*px*/
  /* box-sizing: border-box; */
}
.container-artifacts-associated
  .el-row:nth-child(2)
  .el-col:nth-child(2)
  .el-input--suffix
  .el-input__inner {
  background: #435089;
  color: #ffffff;
}
.el-table .table-head-th {
  background-color: #435089;
  color: white;
}
/* select ä¸‹æ‹‰æŒ‰æŒ‰é’® */
.container-artifacts-associated .el-dialog .el-select {
  flex: 1;
  height: 40px;
  background: rgba(255, 255, 255, 1);
  box-shadow: 0px 3px 7px 0px rgba(229, 229, 229, 1);
  border-radius: 4px;
}
.container-artifacts-associated .el-dialog .el-input--suffix .el-input__inner {
  border: none;
}
.container-artifacts-associated .el-dialog .el-input__suffix {
  background: rgba(67, 80, 137, 1);
  border-radius: 0px 4px 4px 0px;
  right: 0;
  width: 40px;
}
.container-artifacts-associated .el-dialog .el-icon-arrow-up:before {
  /* content: "\e60b"; */
  content: "\e60c";
  /* font-size: 20px; */
  color: rgba(255, 255, 255, 1);
}
.container-artifacts-associated .el-dialog .center-select {
  margin: 0 20px;
}
.input-number .el-input-group--append .el-input__inner,
.el-input-group__prepend {
  height: 40px;
  background: rgba(248, 248, 248, 1);
  border-radius: 4px;
  border: 1px solid rgba(229, 229, 229, 1);
  border-right: 1px dashed #979797;
}
.editable-required-icon,
.el-icon-edit-outline {
  display: none;
}
tbody .el-table__row:nth-child(1) {
  background: #f4f6ff;
}
</style>

<style lang='stylus' scoped rel='stylesheet/stylus'>
* {
  font-size: 18px;
}

.container-artifacts-associated {
  // width: 100%;
  height: 100%;
  padding: 0 20px;
}

.container-artifacts-associated .el-row {
  margin: 20px 0;
}

.container-artifacts-associated .el-row:nth-child(2) .el-col:nth-child(1), .container-artifacts-associated .el-row:nth-child(2) .el-col:nth-child(2) {
  height: 100%;
  background: rgba(255, 255, 255, 1);
}

.container-artifacts-associated .el-row:nth-child(2) .el-col header {
  width: 100%;
  background: #435089;
  color: white;
  text-align: center;
  padding: 0.1rem 0;
}

.container-artifacts-associated .el-row:nth-child(2) .el-col .el-select {
  width: 100%;
  height: 50px;
  color: white;
  text-align: center;
}

.selected {
  background: #4775CA;
  color: white;
}

.el-form-item div {
  margin: 0.1rem 0.6rem;
}

.add_btn {
  background: url('../../../assets/icons/add.png') center 60% no-repeat;
  width: 0.5rem;
  height: 0.5rem;
  display: inline-block;
  float: right;
}

.container-artifacts-associated .el-dialog__head {
  background: linear-gradient(
    225deg,
    rgba(105, 86, 255, 1) 0%,
    rgba(84, 138, 255, 1) 100%
  );
  color: white;
  /* height: 40px; */
}
</style>